(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{155:function(t,e,a){"use strict";a.r(e);var n=a(0),o=a.n(n),s=a(56),c=a.n(s),i=(a(66),a(3)),r=a(4),d=a(7),l=a(6),u=a(57),p=a.n(u),k=a(58),m=a.n(k),f=a(18),h=a.n(f),T=a(59),g=a.n(T),v=function(t){Object(d.a)(a,t);var e=Object(l.a)(a);function a(t){var n;return Object(i.a)(this,a),(n=e.call(this,t)).toggleEditMode=function(){n.setState({editMode:!n.state.editMode})},n.onUpdate=function(){if(""===n.state.textareaValue)return alert("Can't update task: Text is empty!");n.props.Section.onTaskUpdate(n.state.textareaValue),n.toggleEditMode()},n.onTextareaChange=function(t){n.setState({textareaValue:t.target.value})},n.state={editMode:!1,textareaValue:n.props.model.text},n}return Object(r.a)(a,[{key:"render",value:function(){var t=this;return o.a.createElement("div",{className:g.a.Task},this.state.editMode?o.a.createElement("div",null,o.a.createElement("button",{onClick:this.toggleEditMode},"Cancel"),o.a.createElement("button",{onClick:this.onUpdate},"Update"),o.a.createElement("textarea",{onChange:this.onTextareaChange,defaultValue:this.props.model.text})):o.a.createElement("div",null,this.props.config.editable&&o.a.createElement("button",{onClick:this.toggleEditMode},"Edit"),this.props.config.removable&&o.a.createElement("button",{onClick:function(){return t.props.Section.onTaskRemove()}},"Remove"),this.props.config.demotable&&o.a.createElement("button",{onClick:function(){return t.props.Section.onTaskDemote()}},"Demote"),this.props.config.promotable&&o.a.createElement("button",{onClick:function(){return t.props.Section.onTaskPromote()}},"Promote"),o.a.createElement("p",null,this.props.model.text)))}}]),a}(o.a.Component);v.defaultProps={config:{editable:!1,removable:!0,promotable:!0,demotable:!0}};var b=v,x=a(17),M=a.n(x),E=0,O=1,C=2,A=function(t){Object(d.a)(a,t);var e=Object(l.a)(a);function a(t){var n;return Object(i.a)(this,a),(n=e.call(this,t)).onAddTaskButtonPressed=function(){if(""===n.state.textareaValue)return alert("You can't add an empty task!");n.props.Board.addTask(n.state.textareaValue),n.setState({textareaValue:"",charsLeft:250})},n.onTextareaValueChange=function(t){var e=t.target.value,a=250-e.length;n.setState({textareaValue:e,charsLeft:a})},n.state={textareaValue:"",charsLeft:250},n}return Object(r.a)(a,[{key:"buildTasksWidget",value:function(t){var e=this;return t.map((function(t,a){var n=M()(e.props.Board);n.onTaskUpdate=function(t){return e.props.Board.onTaskUpdate(a,t)},n.onTaskRemove=function(){return e.props.Board.onTaskRemove(a)},n.onTaskDemote=function(){return e.props.Board.onTaskDemote(a)},n.onTaskPromote=function(){return e.props.Board.onTaskPromote(a)};var s={editable:e.props.config.position===E,removable:!0,promotable:e.props.config.position!==C,demotable:e.props.config.position!==E};return o.a.createElement(b,{Section:n,key:t.id,model:t,config:s})}))}},{key:"render",value:function(){var t=null;return this.props.tasks&&this.props.tasks.length>0&&(t=this.buildTasksWidget(this.props.tasks)),o.a.createElement("div",null,o.a.createElement("div",{className:h.a.Section},o.a.createElement("h2",null,this.props.model.name),t),this.props.config.hasTaskAdder&&o.a.createElement("div",{className:h.a.TaskAdder},o.a.createElement("span",null,this.state.charsLeft," characters left"),o.a.createElement("textarea",{onChange:this.onTextareaValueChange,value:this.state.textareaValue,maxLength:250}),o.a.createElement("button",{className:h.a.AddTaskBtn,onClick:this.onAddTaskButtonPressed},"Add task")))}}]),a}(o.a.Component);A.defaultProps={config:{hasTaskAdder:!1,position:O}};var B=a(60),y=4,S=900,D=100,_=function(t){var e=Object(B.useMediaQuery)({minDeviceWidth:t.widthBreakpoint}),a=e?100/t.sectionModels.length-t.sectionsGap:t.sectionMaxWidth,n=t.sectionModels.map((function(e,n){var s=M()(t.App);s.addTask=function(e){return t.App.addTask(n,e)},s.onTaskPromote=function(e){return t.App.onTaskPromote(n,e)},s.onTaskDemote=function(e){return t.App.onTaskDemote(n,e)},s.onTaskRemove=function(e){return t.App.onTaskRemove(n,e)},s.onTaskUpdate=function(e,a){return t.App.onTaskUpdate(n,e,a)};var c=0===n,i=n===t.sectionModels.length-1,r={hasTaskAdder:c,position:c?E:i?C:O};return o.a.createElement("div",{key:e.name,style:{width:"".concat(a.toString(),"%")}},o.a.createElement(A,{Board:s,model:e,tasks:e.tasks,config:r}))})),s={display:"flex",flexWrap:e?"nowrap":"wrap",justifyContent:"space-around"};return o.a.createElement("div",{style:s},n)},w=function(t){Object(d.a)(a,t);var e=Object(l.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var t=null;return this.props.sectionModels&&this.props.sectionModels.length>0&&(t=o.a.createElement(_,{sectionModels:this.props.sectionModels,sectionMaxWidth:D,widthBreakpoint:S,sectionsGap:y,App:this.props.App})),o.a.createElement("div",{className:m.a.Board},o.a.createElement("h2",null,this.props.model.name),t)}}]),a}(o.a.Component),R=a(5),j=a.n(R),U=window.location.href,L={LOGOUT:"".concat(U,"accounts/logout"),LOGOUT_SUCCESS_REDIRECT:U,BOARD:"".concat(U,"board/")};j.a.defaults.xsrfCookieName="csrftoken",j.a.defaults.xsrfHeaderName="X-CSRFTOKEN";var P=function(){function t(){Object(i.a)(this,t)}return Object(r.a)(t,[{key:"getBoardData",value:function(t,e){j.a.get(L.BOARD).then((function(e){t(e.data)})).catch((function(t){e(t.message)}))}},{key:"mock_getBoardData",value:function(t,e){t({id:1,name:"Default board",sections:[{id:1,name:"TODO",tasks:[{id:1,text:"something to do #1"},{id:2,text:"something to do #2"},{id:3,text:"something to do #3"}]},{id:2,name:"DOING",tasks:[{id:4,text:"something in progress #1"},{id:5,text:"something in progress #2"},{id:6,text:"something in progress #3"}]},{id:3,name:"DONE",tasks:[{id:7,text:"something already done #1"},{id:8,text:"something already done #2"},{id:9,text:"something already done #3"}]}]})}},{key:"addTask",value:function(t,e,a,n){j.a.post("".concat(L.BOARD,"section/").concat(t,"/task"),{text:e}).then((function(t){a(t.data)})).catch((function(t){n(t.message)}))}},{key:"updateTask",value:function(t,e,a,n,o){j.a.put("".concat(L.BOARD,"section/").concat(t,"/task/").concat(e),{text:a}).then((function(t){n(t.data)})).catch((function(t){o(t.message)}))}},{key:"deleteTask",value:function(t,e,a,n){j.a.delete("".concat(L.BOARD,"section/").concat(t,"/task/").concat(e)).then((function(t){a(t.data)})).catch((function(t){n(t.message)}))}},{key:"promoteTask",value:function(t,e,a,n){j.a.post("".concat(L.BOARD,"section/").concat(t,"/task/").concat(e,"/promote")).then((function(t){a(t.data)})).catch((function(t){n(t.message)}))}},{key:"demoteTask",value:function(t,e,a,n){j.a.post("".concat(L.BOARD,"section/").concat(t,"/task/").concat(e,"/demote")).then((function(t){a(t.data)})).catch((function(t){n(t.message)}))}},{key:"logout",value:function(t,e){j.a.get(L.LOGOUT).then((function(e){t(e)})).catch((function(t){e(t.message)}))}}]),t}(),V=function(t){Object(d.a)(a,t);var e=Object(l.a)(a);function a(t){var n;return Object(i.a)(this,a),(n=e.call(this,t)).onLogout=function(){n.backend.logout((function(){window.location.replace(L.LOGOUT_SUCCESS_REDIRECT)}),(function(t){alert("Could not log out: ".concat(t))}))},n.onTaskPromote=function(t,e){t!==n.state.sectionModels.length-1&&n.backend.promoteTask(n.state.sectionModels[t].id,n.state.sectionModels[t].tasks[e].id,(function(){var a=n.state.sectionModels.slice(),o=a[t].tasks[e];a[t].tasks.splice(e,1),a[t+1].tasks.push(o),n.setState({sectionModels:a})}),(function(t){alert("Could not promote task: ".concat(t))}))},n.onTaskDemote=function(t,e){0!==t&&n.backend.demoteTask(n.state.sectionModels[t].id,n.state.sectionModels[t].tasks[e].id,(function(){var a=n.state.sectionModels.slice(),o=a[t].tasks[e];a[t].tasks.splice(e,1),a[t-1].tasks.push(o),n.setState({sectionModels:a})}),(function(t){alert("Could not demote task: ".concat(t))}))},n.onTaskRemove=function(t,e){window.confirm("Are you sure you want to remove this task?")&&n.backend.deleteTask(n.state.sectionModels[t].id,n.state.sectionModels[t].tasks[e].id,(function(){var a=n.state.sectionModels.slice();a[t].tasks.splice(e,1),n.setState({sectionModels:a})}),(function(t){alert("Could not remove task: ".concat(t))}))},n.onTaskUpdate=function(t,e,a){n.backend.updateTask(n.state.sectionModels[t].id,n.state.sectionModels[t].tasks[e].id,a,(function(a){var o=n.state.sectionModels.slice();o[t].tasks[e].text=a.text,n.setState({sectionModels:o})}),(function(t){alert("Could not update task: ".concat(t))}))},n.addTask=function(t,e){n.backend.addTask(n.state.sectionModels[t].id,e,(function(e){var a=n.state.sectionModels.slice();a[t].tasks.push({id:e.id,text:e.text}),n.setState({sectionModels:a})}),(function(t){alert("Could not add task: ".concat(t))}))},n.state={boardModel:{id:-1,name:""},sectionModels:[]},n.backend=new P,n.App={addTask:n.addTask,onTaskPromote:n.onTaskPromote,onTaskDemote:n.onTaskDemote,onTaskRemove:n.onTaskRemove,onTaskUpdate:n.onTaskUpdate},n}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var t=this;this.backend.getBoardData((function(e){t.setState({boardModel:{id:e.id,name:e.name},sectionModels:e.sections})}),(function(t){alert("Could not get board data: ".concat(t))}))}},{key:"render",value:function(){return o.a.createElement("div",{className:p.a.App},o.a.createElement("button",{onClick:this.onLogout},"Logout"),o.a.createElement("h1",null,"Kanbanlache"),o.a.createElement(w,{App:this.App,model:this.state.boardModel,sectionModels:this.state.sectionModels}))}}]),a}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},18:function(t,e,a){t.exports={Section:"Section_Section__4al1K",TaskAdder:"Section_TaskAdder__2TYSd",AddTaskBtn:"Section_AddTaskBtn__326d3"}},57:function(t,e,a){t.exports={App:"App_App__16ZpL"}},58:function(t,e,a){t.exports={Board:"Board_Board__2a5Bw"}},59:function(t,e,a){t.exports={Task:"Task_Task__10NBU"}},61:function(t,e,a){t.exports=a(155)},66:function(t,e,a){}},[[61,1,2]]]);
//# sourceMappingURL=main.8f1874c6.chunk.js.map